{% extends "news/base.html" %}
{% block title %}Dashboard{% endblock %}

{% block content %}
<h1>Welcome, {{ request.user.username }}</h1>

{% if publisher %}
    <p><strong>Publisher:</strong> {{ publisher.name }}</p>

    {% if publisher.editors.all %}
        <p><strong>Editors:</strong></p>
        <ul>
            {% for editor in publisher.editors.all %}
                <li>{{ editor.username }}</li>
            {% endfor %}
        </ul>
    {% endif %}
{% endif %}


{% if request.user.role == 'editor' %}
    <h2>Articles Pending Approval</h2>
    {% for article in pending_articles %}
        <div class="card">
            <h3>{{ article.title }}</h3>
            <p>{{ article.content|truncatewords:10 }}</p>
            <a href="{% url 'news:approve_article' article.id %}"><button>Review & Approve</button></a>
        </div>
    {% empty %}
        <p>No articles pending approval.</p>
    {% endfor %}

    <h2>Newsletters Pending Approval</h2>
    {% for newsletter in pending_newsletters %}
        <div class="card">
            <h3>{{ newsletter.title }}</h3>
            <p>{{ newsletter.content|truncatewords:10 }}</p>
            <a href="{% url 'news:approve_newsletter' newsletter.id %}"><button>Review & Approve</button></a>
        </div>
    {% empty %}
        <p>No newsletters pending approval.</p>
    {% endfor %}

{% elif request.user.role == 'journalist' %}
    <h2>My Articles</h2>
    <a href="{% url 'news:create_article' %}"><button>Create New Article</button></a>
    {% for article in my_articles %}
        <div class="card">
            <h3>{{ article.title }}</h3>
            <p>{{ article.content|truncatewords:10 }}</p>
            <a href="{% url 'news:article_detail' article.id %}"><button>Read More</button></a>
        </div>
    {% empty %}
        <p>You have not written any articles yet.</p>
    {% endfor %}

    <h2>My Newsletters</h2>
    <a href="{% url 'news:create_newsletter' %}"><button>Create New Newsletter</button></a>
    {% for newsletter in my_newsletters %}
        <div class="card">
            <h3>{{ newsletter.title }}</h3>
            <p>{{ newsletter.content|truncatewords:10 }}</p>
        </div>
    {% empty %}
        <p>You have not created any newsletters yet.</p>
    {% endfor %}

{% elif request.user.role == 'reader' %}
    <h2>Published Articles</h2>
    {% for article in articles %}
        <div class="card">
            <h3>{{ article.title }}</h3>
            <p>{{ article.content|truncatewords:10 }}</p>
            <a href="{% url 'news:article_detail' article.id %}"><button>Read More</button></a>
        </div>
    {% empty %}
        <p>No articles available.</p>
    {% endfor %}

    <h2>Published Newsletters</h2>
    {% for newsletter in newsletters %}
        <div class="card">
            <h3>{{ newsletter.title }}</h3>
            <p>{{ newsletter.content|truncatewords:10 }}</p>
        </div>
    {% empty %}
        <p>No newsletters available.</p>
    {% endfor %}
{% endif %}

{% endblock %}
